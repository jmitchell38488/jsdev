{"componentChunkName":"component---src-templates-blog-post-js","path":"/jmitchell/what-are-side-effects-and-what-you-can-do-about-them-jws","result":{"data":{"site":{"siteMetadata":{"title":"JS.dev Community üë®üèº‚ÄçüíªüöÄüéì"}},"allMarkdownRemark":{"nodes":[{"id":"843cd27b-998f-5647-925c-d72f320e9ed1","timeToRead":10,"fields":{"slug":"/jmitchell/what-are-side-effects-and-what-you-can-do-about-them-jws"},"html":"<p>What are side effects? It‚Äôs one of those questions that gets frequently asked on Stack Overflow, around the\nwater cooler and in interviews, but what does it mean? How do you know if your code or function has a side effect? </p>\n<p>You may have even come across the functional programming aficinado, who has claimed that no side effect code will\nsave the day, and it‚Äôs what functional programming is the bees knees for. I‚Äôll let you in on a little known secret -\nobject-oriented programming can also be developed without side effects; the side effects advice applies equally to both\nparadigms.</p>\n<p>Functional programming has become hot topic in the JavaScript world, with large code bases making heavy use of\ndeclarative paradigm ideas, while practitioners have campaigned for wider adoption.</p>\n<p>Functional programming is the process of building applications, composing it primarily of pure functions, avoiding\nshared state, mutations on data and side effects. It is <a href=\"https://en.wikipedia.org/wiki/Declarative_programming\">declarative</a> rather than\n<a href=\"https://en.wikipedia.org/wiki/Imperative_programming\">imperative</a>, and application state flows from one function to the next.</p>\n<h3 id=\"tldr\" style=\"position:relative;\"><a href=\"#tldr\" aria-label=\"tldr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>tl;dr</h3>\n<p>Functional programming goes someway towards reducing the impact of side effects in code that follows an imperative\nparadigm. Side effects are not only limited to state manipulation, interacting with the I/O, database, log system,\nAPIs and anything else that can be controlled, has a side effect.</p>\n<p>Some side effects are beneficial, and desired, such as the <code class=\"language-text\">setTimeout()</code> function, equivalent to <code class=\"language-text\">sleep()</code> and <code class=\"language-text\">wait()</code>\nin multi-threaded applications. Side effects aren‚Äôt a bad thing, but when hidden, or not otherwise obvious what‚Äôs\nhappening, they can be dangerous.</p>\n<p>Functional programming is not the panacea, but it is a good option, and should be combined with good application design\nand development practices.</p>\n<h3 id=\"breaking-it-down\" style=\"position:relative;\"><a href=\"#breaking-it-down\" aria-label=\"breaking it down permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Breaking it down</h3>\n<p>A side effect is the modification of state through the invocation of a function or expression. In order for a\nfunction or expression to have a side effect, the state it modifies should be out of its local scope. Such as\npassing an object by reference through functions to be mutated and performing I/O operations.</p>\n<p>The presence of side effects in code is neither a good or bad thing. They are inevitable in some cases, such as when\nworking with languages that follow the imperative programming paradigm, or when mutating state through necessity.</p>\n<p>In functional programming, functions are often designed to avoid side effects, with the result of most function calls\nbeing a derived value from the input parameters. The lack of side effects makes it easier to do formal verifications,\nand tends to lean towards an easier method of testing.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8e6c3596e269e780e30bd7cbe7dd8297/50383/hero.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.86486486486486%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABSklEQVQY002RW2+CQBSE9///Gw1B8VoEBDVKlCBCAS31EqMGRKvGmNCv+NLztOfszJzZWTGfz33f9zzPcZzRaCRJUqPRuFwu2+220+l8lNVqtUzTtCyrWq1WKpVarSbLMnMRx/HXv1osFrZtz2YzRHVd73a7vV5PVdXpdDqZTJrNZr/fb7fbmqYBE+i9tZMkgUDLEiwsl8vBYACCYZ7nz+cTL67rjsdjhIbDIU7Fd1lAwzDEPwgu4HM4n89RFLEQO7Sr1Qoaukw4n06nP/Ltdns8HlmWHY/HoiiYsGG3212vV+ygiMRms2E/ACa8jha84O6zLBxCIDlU34ogmNCCxkWapuv1GoO0OGWNQIkT2SDPlKhwBed+v+/3e5hkHgQBTPgovuM8HA6v10vwQiLhD0iCDAzDqNfr2Ib2UxarMMwTgOGLRBVFIQXmv3xKloQi+D2oAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"side effect functions everywhere\"\n        title=\"side effect functions everywhere\"\n        src=\"/static/8e6c3596e269e780e30bd7cbe7dd8297/fcda8/hero.png\"\n        srcset=\"/static/8e6c3596e269e780e30bd7cbe7dd8297/12f09/hero.png 148w,\n/static/8e6c3596e269e780e30bd7cbe7dd8297/e4a3f/hero.png 295w,\n/static/8e6c3596e269e780e30bd7cbe7dd8297/fcda8/hero.png 590w,\n/static/8e6c3596e269e780e30bd7cbe7dd8297/50383/hero.png 740w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"shared-state\" style=\"position:relative;\"><a href=\"#shared-state\" aria-label=\"shared state permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Shared state</h3>\n<p>A shared state is any kind of shared state, an object, variable or memory space, that exists in a shared scope, such\nas closures, classes, functions and even global scopes, or as the input property being passed through functions.</p>\n<p>The problem with shared state is by virtue its shared nature; you need to know the history of the object, shared\nevents and other potential points of mutation and interaction.</p>\n<p>A common side effect of shared state are race conditions. For example, imagine you have a <code class=\"language-text\">User</code> object, with a\nfunction <code class=\"language-text\">saveUser()</code>, which makes a request to an API. While that process is happening, the user modifies their\nprofile and saves their data again, thus calling <code class=\"language-text\">saveUser()</code> a second time. Unfortunately for the user, the second\nrequest was received, processed, and their record updated before the first one completed.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cb41b0136f3d11c462b9998daa42e8e3/eea4a/racecondition.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFAv/EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAGspURNUTYb/wD/xAAaEAACAgMAAAAAAAAAAAAAAAABAgADEBET/9oACAEBAAEFAuccasxY7B2Yk//EABcRAAMBAAAAAAAAAAAAAAAAAAACEQH/2gAIAQMBAT8BRtpT/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8BZ//EABkQAAIDAQAAAAAAAAAAAAAAAAABEBEhMv/aAAgBAQAGPwLtm25dM0//xAAYEAEBAQEBAAAAAAAAAAAAAAABABEhMf/aAAgBAQABPyFas7hxHsmWRNgW2W8v/9oADAMBAAIAAwAAABCI3//EABURAQEAAAAAAAAAAAAAAAAAAAEA/9oACAEDAQE/EEQSX//EABYRAAMAAAAAAAAAAAAAAAAAAAABEf/aAAgBAgEBPxBFCH//xAAbEAEBAQEAAwEAAAAAAAAAAAABEQAxQVFhof/aAAgBAQABPxBKCrZefuKXRI7Z5yKIj9NHdwfDIejG6xAw5v/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"race condition in multi-threaded applications\"\n        title=\"race condition in multi-threaded applications\"\n        src=\"/static/cb41b0136f3d11c462b9998daa42e8e3/1c72d/racecondition.jpg\"\n        srcset=\"/static/cb41b0136f3d11c462b9998daa42e8e3/a80bd/racecondition.jpg 148w,\n/static/cb41b0136f3d11c462b9998daa42e8e3/1c91a/racecondition.jpg 295w,\n/static/cb41b0136f3d11c462b9998daa42e8e3/1c72d/racecondition.jpg 590w,\n/static/cb41b0136f3d11c462b9998daa42e8e3/a8a14/racecondition.jpg 885w,\n/static/cb41b0136f3d11c462b9998daa42e8e3/fbd2c/racecondition.jpg 1180w,\n/static/cb41b0136f3d11c462b9998daa42e8e3/eea4a/racecondition.jpg 1280w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>When working with shared state, there are strategies to mitigate collisions, races and deadlocks.</p>\n<p>Another problem with shared state is the cascading function problem, in which the order and even timing of function\ncalls has to be changed as the state changes. This is typically a side effect of changing the order of functions\ncalls, which causes a cascade of errors.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  myVal<span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">doSomething</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>myVal <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleSomeEvent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>myVal <span class=\"token operator\">+=</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// state.myVal = 2;</span>\n<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>myVal<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span>\n    <span class=\"token function\">handleSomeEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// state.myVal = 4;</span>\n    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span> <span class=\"token comment\">// { myVal: 4 }</span></code></pre></div>\n<p>If we don‚Äôt call <code class=\"language-text\">doSomehing()</code> before our switch statement, <code class=\"language-text\">handleSomeEvent()</code> doesn‚Äôt even get called, and the\nsame thing happens when the invocation of <code class=\"language-text\">doSomething()</code> is shifted <em>after</em> the switch statement.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  myVal<span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">doSomething</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>myVal <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleSomeEvent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>myVal <span class=\"token operator\">+=</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>myVal<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span>\n    <span class=\"token function\">handleSomeEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// never gets called</span>\n    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// state.myVal = 2;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span> <span class=\"token comment\">// { myVal: 2 }</span></code></pre></div>\n<p>Introducing pure functions following the functional programming paradigm helps us avoid shared state, thus avoiding\nissues such as cascading function errors, potential race conditions, and situations where state is stale.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  myVal<span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">f</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">{</span> myVal<span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>myVal <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">g</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">{</span> myVal<span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>myVal <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> newState <span class=\"token operator\">=</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { myVal: 1 }</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>newState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { myVal: 2}</span>\n\n<span class=\"token keyword\">const</span> finalState <span class=\"token operator\">=</span> <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token function\">f</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { myVal: 1 }</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>finalState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { myVal: 4 }</span></code></pre></div>\n<p><a href=\"https://codepen.io/jmitchell38488/pen/NWNJrzz\">Check it out on codepen</a>.</p>\n<p>In the example above, using the object spread, we‚Äôre able to <em>copy</em> the values of the input onto our output state,\nwhile performing the mutations to the new object that we need, rather than mutating the values of <code class=\"language-text\">state</code> directly.\nThis is a common pattern in JavaScript for copying values in one object into another, such as setting default values.</p>\n<p>The order of function calls still matter, as the result can change depending in which order you call the functions in.\nThe function composition (taking two functions to produce a single function) of <code class=\"language-text\">f</code> and <code class=\"language-text\">g</code> ‚Üí <code class=\"language-text\">f(g(x))</code> does not\nalways equal to composition of <code class=\"language-text\">g(f(x))</code>. In our example above it does, but what if <code class=\"language-text\">g</code> performs a multiplication\nrather than an addition? <code class=\"language-text\">f(g(x)) ‚â† g(f(x))</code>.</p>\n<h3 id=\"immutability\" style=\"position:relative;\"><a href=\"#immutability\" aria-label=\"immutability permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Immutability</h3>\n<p>An immutable object is an object that can‚Äôt be modified after creation, through manipulation of a property, or\nthrough assignment. A mutable object is an object which can be modified.</p>\n<p>Immutability and data flow is a central concept in functional programming. In JavaScript, it‚Äôs important not to\nconfuse the keyword <code class=\"language-text\">const</code> with immutability; <code class=\"language-text\">const</code> declares a variable that cannot be reassigned after it has\nbeen created. </p>\n<p>You can‚Äôt create immutable objects in JavaScript by default. While <code class=\"language-text\">const</code> prevents value reassignments, you can\nstill change the properties and values of objects and arrays, assigned to <code class=\"language-text\">const</code>, <code class=\"language-text\">let</code> and <code class=\"language-text\">var</code>.</p>\n<p>However, immutable objects can still be achieved in JavaScript by using the <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze\">Object.freeze</a>, which\nprevents the modification of the object one-level deep, thus making it partially immutable.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">freeze</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  myVal<span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nstate<span class=\"token punctuation\">.</span>myVal <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>myVal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1</span>\n\n<span class=\"token keyword\">const</span> myObj <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">freeze</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  nested<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> myVal<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmyObj<span class=\"token punctuation\">.</span>nested<span class=\"token punctuation\">.</span>myVal <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>myObj<span class=\"token punctuation\">.</span>nested<span class=\"token punctuation\">.</span>myVal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 2</span></code></pre></div>\n<p>Frozen objects are only superficially frozen; to achieve immutable objects, you will need to deep-freeze the object,\nby recursively calling <code class=\"language-text\">Object.freeze</code> over all properties in the object, from the deepest child and work your way up.</p>\n<p>Thera are several libraries in JavaScript that provide <a href=\"https://en.wikipedia.org/wiki/Trie\">trie data structure</a>-like behaviour with immutable\nstores, such as <a href=\"https://immutable-js.github.io/immutable-js/\">immutable.js</a> and <a href=\"https://swannodette.github.io/mori/\">mori</a>.</p>\n<h3 id=\"idempotency---lets-get-mathematic\" style=\"position:relative;\"><a href=\"#idempotency---lets-get-mathematic\" aria-label=\"idempotency   lets get mathematic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Idempotency - lets get mathematic!</h3>\n<p>Contrary to what some may suggest, a side effect isn‚Äôt a bad thing. It does not have to be hidden or unexpected\nbehaviour. It also has nothing to do with <a href=\"https://en.wikipedia.org/wiki/Idempotence#Computer_science_meaning\">idempotency</a> in computer science - an idempotent function\ncan have side effects, while a non-idempotent function may have no side effects.</p>\n<p>A function (or subroutine) is considered idempotent in computer science when:</p>\n<ul>\n<li>In imperative programming, the system state remains the same after one or more invocations of a function\n(or subroutine) with side effects,</li>\n<li>A pure function in functional programming,</li>\n<li>A function is idempotent in the mathematical sense</li>\n</ul>\n<p>A function <code class=\"language-text\">f()</code> with side effects is idempotent under sequential composition <code class=\"language-text\">f; f</code> if, when called n-times with the\nsame list of arguments, the nth call has no side effects, and returns the same value as the first invocation,\nassuming no other procedures were called.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Idempotent function</span>\n<span class=\"token keyword\">var</span> x <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  x <span class=\"token operator\">=</span> n<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// x = 5</span>\n<span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// x = 5</span>\n<span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// x = 5</span></code></pre></div>\n<p>A typical example of an idempotent function, is a function that queries a database for a customer‚Äôs name and address.</p>\n<h3 id=\"the-influence-of-functional-programming\" style=\"position:relative;\"><a href=\"#the-influence-of-functional-programming\" aria-label=\"the influence of functional programming permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The influence of functional programming</h3>\n<p>There is a growing ground swell from functional programming enthusiasts, that advocate for less side effect\ndriven code. There could also be confusion between side effects and <a href=\"https://en.wikipedia.org/wiki/Pure_function\">pure functions</a> - a function that is\n(a) idempotent, (b) has no side effects, and (c) will return the same output for the same parameters, every time.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// pure function</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">++</span>x<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Although the code sample above does not look like it is pure, it actually is. The value of <code class=\"language-text\">x</code> can only be observed\nin other invocations of <code class=\"language-text\">f()</code>, and <code class=\"language-text\">f()</code> does not communicate or cache the value of <code class=\"language-text\">x</code> to its environment.</p>\n<p>A function is not pure and has no side effects, if the result of the invocation of the function is different\neach time without modifying state.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// non-pure function  </span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">z</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">++</span>x<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>A function is both not pure and has side effects if during the invocation, it modifies state. This can be state that\nis passed to it as an input parameter, or state that it can access through its closure scope.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> counter <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">++</span>counter<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// counter is now 2</span>\n\n<span class=\"token keyword\">let</span> val <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">square</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> x <span class=\"token operator\">*=</span> x<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">square</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// val = 4</span></code></pre></div>\n<p>While classes colocate functionality and bound together under the namespace of the object class, functional programming\ntends to reuse a collection of functional utilities to process data. </p>\n<p>Typically in functional programming, any type of data is fair game. For example, being able to use the <code class=\"language-text\">map</code> utility\nfunction to map over objects, strings, arrays and other data types. This is achieved by using <strong>higher-order\nfunctions</strong>, which is a function that takes a function as an argument, returns a function, or both.</p>\n<p>JavaScript has <strong>first class functions</strong>, which allows us to treat functions as data and assign them to variables,\npass them as arguments, return them from other function calls, etc.</p>\n<h3 id=\"so-its-not-all-bad\" style=\"position:relative;\"><a href=\"#so-its-not-all-bad\" aria-label=\"so its not all bad permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>So it‚Äôs not all bad?</h3>\n<p>So far we‚Äôve covered what happens when a function assigns a new value to a variable, or looks like a pure function,\nbut may not be one. Other side effects can happen when a function call invokes another function.</p>\n<p>In multi-threaded applications, pausing a thread is a side effect. The state of the application has been modified in\nsome way, and in some cases functions like <code class=\"language-text\">sleep()</code> or <code class=\"language-text\">wait()</code> are only useful for their side effects.</p>\n<p>The term side effect may sound negative, but normally effect of calling a function is the very purpose of the\nfunction itself. In some way there is a side effect, be it memory or cpu utilisation, storing data to a database,\ncreating a system log, communicating with a message bus server, etc.</p>\n<p>In mathematics, the function is a mapping from a tuple of values (input) to a single value (output). So, given\nfunction <code class=\"language-text\">f</code> and a value <code class=\"language-text\">x</code>, <code class=\"language-text\">f(x)</code> will always yield the same result <code class=\"language-text\">y</code>. This is the basis of the pure function,\nbut is often different to what the concept of a function (procedure) is in many programming languages, which is more\nof a construct.</p>\n<p>Given the mathematical nature of what a function is, and how that differs in programming languages, there‚Äôs bound to\nbe side effects in the invocation of any function, just that most of those are abstracted away from us, so that we\ndon‚Äôt know about it.</p>\n<h3 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h3>\n<p>There are instances though when following the declarative programming paradigm, that creating pure functions is a\ncleaner, safer and an easier way to develop. JavaScript has made great strides towards incorporating functional\nprogramming ideas into many of its languages features since ES2015, such as with the <code class=\"language-text\">Array.*</code> functions.</p>\n<p>The negative aspect of side effects normally comes from cases where side effects are hidden or unknown. This is bad\nprogramming in the first place and should be avoided at all costs. Any code that produces a side effect should make\nit clear that it is doing so. Even Haskell, one of the most popular functional programming languages, still allowed\nI/O operations.</p>\n<p>Statelessness is one approach to avoiding side effects, but that only takes into considering that state is cached and\nstored inside the application. Often this isn‚Äôt the case, such as with RESTful APIs, or Web UIs that don‚Äôt cache data\nlocally.</p>\n<p>In general, most applications will combined the declarative and imperative programming paradigms. There‚Äôs a fine\nbalancing act between the declarative (what do to) and imperative (how to do) paradigms, with more a shift in the\ncommunity towards declarative programming.</p>\n<p>Practicing good software design principles, adopting declarative coding paradigm where necessary, and utilising\nimmutable objects is a solid step in the right direction. </p>","excerpt":"What are side effects? It‚Äôs one of those questions that gets frequently asked on Stack Overflow, around the\nwater cooler and‚Ä¶","frontmatter":{"date":"September 26, 2020","publishedDate":"September 26, 2020","updatedDate":"September 26, 2020","published":true,"title":"What are side effects, and what you can do about them","authors":["jmitchell"],"posttags":["javascript","design","functional"],"hero":{"childImageSharp":{"fluid":{"src":"/static/f508f9cf3b0c1b2d1a463317e739334d/4fe8c/hero.jpg"}}}}}]}},"pageContext":{"authors":["jmitchell"],"slug":"/jmitchell/what-are-side-effects-and-what-you-can-do-about-them-jws","previous":{"id":"67f019f3-2e5d-5e0f-945d-8962239dbe1e","fields":{"slug":"/jmitchell/what-is-hoisting-and-how-it-works-in-javascript-e1e"},"timeToRead":6,"frontmatter":{"date":"25 Sep, 2020","publishedDate":"25 Sep, 2020","updatedDate":"26 Sep, 2020","title":"What is hoisting and how it works in JavaScript","authors":["jmitchell"],"posttags":["javascript"],"uid":"7wlkfi8ae1e"}},"next":{"id":"c31bd454-e084-5631-8679-ed997be1d7f2","fields":{"slug":"/jmitchell/how-to-get-started-writing-unit-tests-for-react-with-enzyme-and-jest-mfw"},"timeToRead":17,"frontmatter":{"date":"01 Oct, 2020","publishedDate":"03 Oct, 2020","updatedDate":null,"title":"How to get started writing unit tests for React with jest and enzyme","authors":["jmitchell"],"posttags":["javascript","tutorial","react","testing"],"uid":"1fbkfq6nmfw"}}}},"staticQueryHashes":["1149526610","1635669961","2756842759","2837448543","3763906766"]}