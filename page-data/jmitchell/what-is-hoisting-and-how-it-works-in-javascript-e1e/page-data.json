{"componentChunkName":"component---src-templates-blog-post-js","path":"/jmitchell/what-is-hoisting-and-how-it-works-in-javascript-e1e","result":{"data":{"site":{"siteMetadata":{"title":"JS.dev Community üë®üèº‚ÄçüíªüöÄüéì"}},"allMarkdownRemark":{"nodes":[{"id":"67f019f3-2e5d-5e0f-945d-8962239dbe1e","timeToRead":6,"fields":{"slug":"/jmitchell/what-is-hoisting-and-how-it-works-in-javascript-e1e"},"html":"<p>The famed and often confusing term, certainly for any JavaScript developer, and it leaves many scratching their heads; what exactly is hoisting?</p>\n<p>Hoisting is a term that describes a mechanism in JavaScript to provide early-access to declarations.</p>\n<blockquote>\n<p>Hoisting is a JavaScript mechanism where variables and function declarations are moved to the top of their scope before code execution.</p>\n</blockquote>\n<p>Ever wondered why in JavaScript you can interact with your variables and functions before they‚Äôve been declared? Then read on!</p>\n<h5>tl;dr</h5>\n<p>Conceptually speaking, hoisting is the movement of declaractions - variables and functions - to the top of their scope, while assignments are left in place. What really happens, is that during compile time, the declarations are put into memory <em>first</em>, but physically remain in place in your code.</p>\n<p>The benefit of doing this is that you get access to functions and variables <em>before</em> they‚Äôre declared in code. This only applies to <em>declarations</em>, not to expressions, and not to initializing an undeclared variable.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">bar</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// do something</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>It‚Äôs important to remember that <em>only</em> declarations are hoisted into memory during compile time, <em>not</em> assignments.</p>\n<h2>Only declarations are hoisted</h2>\n<p>JavaScript only hoists the declarations of functions and variables into memory during compile time, <em>not</em> the assignments. This means that if a variable is declared and initialized after using it, the value will be <code class=\"language-text\">undefined</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>foo<span class=\"token punctuation\">)</span> <span class=\"token comment\">// prints 'undefined' as only the _declaration_ was hoisted</span>\n<span class=\"token keyword\">var</span> foo<span class=\"token punctuation\">;</span> <span class=\"token comment\">// declaration</span>\nfoo <span class=\"token operator\">=</span> <span class=\"token string\">\"bar\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// initialization</span></code></pre></div>\n<p>The following is an example of initialization returning a <code class=\"language-text\">ReferenceError</code>. In this case, a variable is only initialized, not declared; in order to declare something to be hoisted in JavaScript, it must either be explicitly declared as a <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements\">var or function</a>, as implicit declaractions (initialization only) wont be hoisted.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>foo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// prints 'ReferenceError: foo is not defined'</span>\nfoo <span class=\"token operator\">=</span> <span class=\"token string\">\"bar\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// only initialization, no declaration, value did not follow var</span></code></pre></div>\n<p>It‚Äôs important to remember that only the <em>declaration</em> is hoisted, even if a value is assigned.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>foo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// prints 'undefined'</span>\n<span class=\"token keyword\">var</span> foo <span class=\"token operator\">=</span> <span class=\"token string\">\"bar\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Hoisting variables</h3>\n<p>JavaScript allows us to declare and initialize our variables simultaneously. However, the engine separates the declaration and initialization of variables, and executes it as separate steps, thus allowing the engine to hoist declarations above initializations.</p>\n<p>All function and variable <em>declarations</em> are hoisted to the top of their scope, while variable declarations are processed ahead of function declarations; which is why you can call functions with yet-to-be-declared variables, and get an <code class=\"language-text\">undefined</code> error.</p>\n<p>However, there is a caveat. When <em>initializing</em> a variable, that hasn‚Äôt yet been declared yet, the variable is hoisted to the global scope when it is executed, rather than hoisted to its scope, like the function it‚Äôs being initialized in. This <em>only</em> happens on execution, not at compile time.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  doing <span class=\"token operator\">=</span> <span class=\"token string\">\"something\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>doing<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ReferenceError: doing is not defined</span>\n<span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>doing<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// something</span></code></pre></div>\n<p>This is distinctly different to scoped variable declarations, which only exist within their scope. </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> doing <span class=\"token operator\">=</span> <span class=\"token string\">\"something\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>doing<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ReferenceError: doing is not defined</span>\n<span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>doing<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ReferenceError: doing is not defined</span></code></pre></div>\n<p>The take-away is, that <em>declared</em> variables are hoisted to the top of their scope at <strong>compiled time</strong>, while <em>undeclared</em> variables are hoised to the global scope <strong>during execution</strong>.</p>\n<h3>Declarations using <code class=\"language-text\">let</code> and <code class=\"language-text\">const</code> are not hoisted to global space</h3>\n<p><code class=\"language-text\">let</code> and <code class=\"language-text\">const</code> were introduced in ES6 for scope-based operations, but unlike <code class=\"language-text\">var</code>, do not get hoisted to global space during compile time. Variables declared with <code class=\"language-text\">let</code> are block scoped and not function scoped. This is significant, because unlike <code class=\"language-text\">var</code>, there‚Äôs no risk of variable leakage outside of the scope of execution.</p>\n<p>The downside is that <code class=\"language-text\">const</code> and <code class=\"language-text\">let</code> do not get hoisted, in local or global scope. Read more about <a href=\"https://thejs.dev/jmitchell/const-let-var-javascript-variables-and-immutability-00b\">var, const and let</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>foo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// prints 'ReferenceError: foo is not defined'</span>\n<span class=\"token keyword\">const</span> foo <span class=\"token operator\">=</span> <span class=\"token string\">\"bar\"</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>bar<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// prints 'ReferenceError: bar is not defined'</span>\n<span class=\"token keyword\">let</span> bar <span class=\"token operator\">=</span> <span class=\"token string\">\"bar\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Strict mode prevents sloppy hoisting</h3>\n<p>Introduced as a utility in ES5, <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode\">strict-mode</a> is a way to <em>opt in</em> to a restricted variant of JavaScript, implicitly opting-out of <a href=\"https://developer.mozilla.org/docs/Glossary/Sloppy_mode\">sloppy mode</a>. It introduces different semantics, such as eliminating some silent errors, improves some optimizations and prohibits some syntax, such as accessing variables before they‚Äôve been declared.</p>\n<p>You can opt-in to strict-mode by pre-facing your file, or function with <code class=\"language-text\">use strict</code> at the top of the scope, before any code is declared:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token string\">'use strict'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// or</span>\n<span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>We can test if we can access initializations ahead of time with strict-mode enabled:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  foo <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>foo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// prints 'ReferenceError: foo is not defined'</span></code></pre></div>\n<h3>Not all functions are hoisted alike</h3>\n<p>Function are classified as either function declarations, or function expressions. The important difference between the two, when discussing hoisting, is <em>declaration</em>. A declared function <em>will be hoisted</em>, while a function created through an expression <em>will not</em> be hoisted. </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> hoistedFunction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// prints 'function'</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> unhoistedFunction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// prints 'undefined'</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">hoistedFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// This function _will_ hoisted, because it is *declared* as a function</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">unhoistedFunction</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// This function _will not_ be hoisted because it is declared through an expression of a variable, and therefore will be undefined </span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Order of hoisting precedence matters</h3>\n<p>There are two rules you have to keep in mind when working with hoisted functions and variables:</p>\n<ol>\n<li>Function declaration takes precedence over variable declarations</li>\n<li>Variable assignment takes precedence over expression function </li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> myVar<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// prints 'undefined'</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> myFunc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// prints 'function'</span>\n<span class=\"token keyword\">var</span> myVar <span class=\"token operator\">=</span> <span class=\"token string\">\"foo\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// declaration and initialization</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">myFunc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> <span class=\"token comment\">// declaration</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> myVar<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// prints 'string'</span></code></pre></div>\n<p>We can take a deeper look at the steps during the compilation and execution cycle to see what‚Äôs happening with our declaration and initializations:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">myFunc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> myVar<span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> myVar<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> myFunc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmyVar <span class=\"token operator\">=</span> <span class=\"token string\">\"foo\"</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> myVar<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Classes are not hoisted</h3>\n<p>Classes in JavaScript are in fact special functions, and just as you can define functions with declaration and expression, the class syntax has the same two components: <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes\">class expressions and class declarations</a>.</p>\n<p>Unlike functions and variables, classes <em>do not</em> get hoisted, either through declaration or expression. You need to declare your class before you can use it.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> p <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Rectangle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ReferenceError</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> Rectangle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ReferenceError</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Rectangle</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Conclusion</h3>\n<p>Let‚Äôs summarise what we‚Äôve learned:</p>\n<ol>\n<li>Hoisting is a mechanism that inserts variable and function declaractions into memory ahead of assignment and initialization within the given scope of execution</li>\n<li><code class=\"language-text\">const</code>, <code class=\"language-text\">let</code>, function expressions and classes <em>do not</em> get hoisted, and cannot be read or accessed before their declaration</li>\n<li><code class=\"language-text\">safe-mode</code> prevents sloppy hoisting of initialized undeclared variables onto the global scope</li>\n</ol>\n<p>To avoid hoisting confusion and issues in the longterm, it‚Äôs better to declare your variables and functions ahead of initialization and access. You‚Äôll avoid a whole set of potentially nasty bugs and <code class=\"language-text\">undefined</code> warnings polluting your console.</p>","excerpt":"The famed and often confusing term, certainly for any JavaScript developer, and it leaves many scratching their heads; what‚Ä¶","frontmatter":{"date":"September 25, 2020","publishedDate":"September 25, 2020","updatedDate":"September 26, 2020","title":"What is hoisting and how it works in JavaScript","authors":["jmitchell"],"posttags":["javascript"],"hero":{"childImageSharp":{"fluid":{"src":"/static/805ce41923f98ef029a5a27c2d64707b/ee604/hero.png"}}}}}]}},"pageContext":{"authors":["jmitchell"],"slug":"/jmitchell/what-is-hoisting-and-how-it-works-in-javascript-e1e","previous":{"id":"a81aa843-a67e-5d78-9f62-69e56984800b","fields":{"slug":"/jmitchell/const-let-var-javascript-variables-and-immutability-a6c"},"timeToRead":5,"frontmatter":{"date":"01 Aug, 2020","publishedDate":"01 Aug, 2020","updatedDate":null,"title":"const, let, var; JavaScript variables and immutability","authors":["jmitchell"],"posttags":["javascript","webdev","beginners","codenewbie"],"uid":"7djkfi87a6c"}},"next":{"id":"843cd27b-998f-5647-925c-d72f320e9ed1","fields":{"slug":"/jmitchell/what-are-side-effects-and-what-you-can-do-about-them-jws"},"timeToRead":10,"frontmatter":{"date":"26 Sep, 2020","publishedDate":"26 Sep, 2020","updatedDate":"26 Sep, 2020","title":"What are side effects, and what you can do about them","authors":["jmitchell"],"posttags":["javascript","design","functional"],"uid":"1q1kfif1jws"}}}},"staticQueryHashes":["1149526610","1635669961","2756842759","2801668113","3763906766"]}